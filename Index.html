<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Small Thermal Style Food Bill Generator</title>
<style>
  body {
    font-family: 'Courier New', Courier, monospace;
    background: #f8f8f8;
    margin: 20px;
    color: #000;
  }
  #bill-container {
    width: 280px;
    background: #fff;
    padding: 10px 15px;
    margin: auto;
    box-shadow: 0 0 5px rgba(0,0,0,0.2);
  }
  #header {
    text-align: center;
    margin-bottom: 8px;
    border-bottom: 1px dashed #000;
    padding-bottom: 6px;
  }
  #header h2, #header p {
    margin: 2px 0;
    font-weight: normal;
  }
  #bill-number {
    text-align: right;
    font-size: 12px;
  }
  #items-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 14px;
    margin-top: 8px;
  }
  #items-table th, #items-table td {
    padding: 4px 0;
    border-bottom: 1px dashed #000;
    text-align: left;
  }
  #items-table th {
    font-weight: bold;
    font-size: 13px;
  }
  #items-table td.rate, #items-table td.total {
    text-align: right;
  }
  #total-row td {
    border-top: 1px solid #000;
    font-weight: bold;
    font-size: 15px;
  }
  #bill-footer {
    text-align: center;
    margin-top: 10px;
    font-size: 12px;
    border-top: 1px dashed #000;
    padding-top: 6px;
  }
  input, button {
    font-family: monospace;
    font-size: 13px;
  }
  input[type="text"], input[type="number"] {
    width: 90%;
    margin-bottom: 6px;
    padding: 4px;
    box-sizing: border-box;
  }
  input[type="number"] {
    text-align: right;
  }
  .item-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 6px;
  }
  .item-row input[type="text"] {
    width: 60%;
  }
  .item-row input[type="number"] {
    width: 30%;
  }
  #add-item-btn {
    width: 100%;
    padding: 6px;
    margin-bottom: 12px;
  }
  #style-select {
    margin-bottom: 12px;
    width: 100%;
    padding: 6px;
  }
</style>
</head>
<body>

<div id="controls" style="max-width:280px; margin:auto;">
  <label for="hotel-name">Hotel/Restaurant Name</label><br />
  <input type="text" id="hotel-name" placeholder="Enter hotel name" value="My Restaurant" /><br />

  <label for="hotel-place">Place</label><br />
  <input type="text" id="hotel-place" placeholder="Enter place" value="My City" /><br />

  <label for="bill-number-input">Bill Number</label><br />
  <input type="text" id="bill-number-input" placeholder="Enter bill number" value="0001" /><br />

  <label for="style-select">Select Receipt Style</label><br />
  <select id="style-select">
    <option value="style1">Classic Thermal Style</option>
    <option value="style2">Compact Minimal Style</option>
  </select><br />

  <div id="items-inputs">
    <div class="item-row">
      <input type="text" placeholder="Item name" class="item-name" />
      <input type="number" placeholder="Rate" class="item-rate" min="0" step="0.01" />
    </div>
  </div>
  <button id="add-item-btn">+ Add Item</button>

  <button id="generate-btn" style="width:100%;">Generate Bill</button>
  <button id="print-btn" style="width:48%;">Print</button>
  <button id="download-btn" style="width:48%;">Download PDF</button>
</div>

<div id="bill-container" style="display:none; margin-top:20px;">
  <!-- Bill will be generated here -->
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
  const addItemBtn = document.getElementById('add-item-btn');
  const itemsInputs = document.getElementById('items-inputs');
  const generateBtn = document.getElementById('generate-btn');
  const printBtn = document.getElementById('print-btn');
  const downloadBtn = document.getElementById('download-btn');
  const billContainer = document.getElementById('bill-container');

  addItemBtn.onclick = () => {
    const div = document.createElement('div');
    div.classList.add('item-row');
    div.innerHTML = `
      <input type="text" placeholder="Item name" class="item-name" />
      <input type="number" placeholder="Rate" class="item-rate" min="0" step="0.01" />
    `;
    itemsInputs.appendChild(div);
  };

  function generateBillHTML(style) {
    const hotelName = document.getElementById('hotel-name').value.trim() || 'My Restaurant';
    const hotelPlace = document.getElementById('hotel-place').value.trim() || 'My City';
    const billNumber = document.getElementById('bill-number-input').value.trim() || '0001';

    const items = Array.from(document.querySelectorAll('.item-row')).map(row => ({
      name: row.querySelector('.item-name').value.trim(),
      rate: parseFloat(row.querySelector('.item-rate').value)
    })).filter(item => item.name && !isNaN(item.rate));

    const total = items.reduce((sum, item) => sum + item.rate, 0).toFixed(2);

    let html = '';
    if (style === 'style1') {
      html += `
        <div id="header">
          <h2>${hotelName}</h2>
          <p>${hotelPlace}</p>
          <p>Bill No: ${billNumber}</p>
        </div>
        <table id="items-table">
          <thead>
            <tr><th>Item</th><th>Rate</th></tr>
          </thead>
          <tbody>
            ${items.map(item => `<tr><td>${item.name}</td><td class="rate">${item.rate.toFixed(2)}</td></tr>`).join('')}
          </tbody>
          <tfoot>
            <tr id="total-row"><td>Total</td><td class="total">${total}</td></tr>
          </tfoot>
        </table>
        <div id="bill-footer">Thank you for your visit!</div>
      `;
    } else if (style === 'style2') {
      html += `
        <div id="header" style="font-size: 14px;">
          <strong>${hotelName}</strong><br />
          <em>${hotelPlace}</em><br />
          Bill #: ${billNumber}
        </div>
        <table id="items-table" style="font-size: 13px;">
          <tbody>
            ${items.map(item => `<tr><td>${item.name}</td><td class="rate">${item.rate.toFixed(2)}</td></tr>`).join('')}
            <tr id="total-row"><td><strong>Total</strong></td><td class="total"><strong>${total}</strong></td></tr>
          </tbody>
        </table>
        <div id="bill-footer" style="font-size: 11px;">Visit Again!</div>
      `;
    }
    return html;
  }

  generateBtn.onclick = () => {
    const style = document.getElementById('style-select').value;
    const billHTML = generateBillHTML(style);
    billContainer.innerHTML = billHTML;
    billContainer.style.display = 'block';
  };

  printBtn.onclick = () => {
    if (billContainer.style.display === 'none') {
      alert('Generate the bill first!');
      return;
    }
    const printWindow = window.open('', '', 'height=500,width=350');
    printWindow.document.write('<html><head><title>Print Bill</title>');
    printWindow.document.write('<style>body { font-family: monospace; }</style>');
    printWindow.document.write('</head><body >');
    printWindow.document.write(billContainer.innerHTML);
    printWindow.document.write('</body></html>');
    printWindow.document.close();
    printWindow.focus();
    printWindow.print();
    printWindow.close();
  };

  downloadBtn.onclick = () => {
    if (billContainer.style.display === 'none') {
      alert('Generate the bill first!');
      return;
    }
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF({
      unit: 'pt',
      format: [280, 400],
      compress: true,
    });

    // Convert billContainer content for jsPDF text
    let y = 20;
    const hotelName = document.getElementById('hotel-name').value.trim() || 'My Restaurant';
    const hotelPlace = document.getElementById('hotel-place').value.trim() || 'My City';
    const billNumber = document.getElementById('bill-number-input').value.trim() || '0001';

    doc.setFont('Courier', 'normal');
    doc.setFontSize(14);
    doc.text(hotelName, 10, y);
    y += 18;
    doc.setFontSize(11);
    doc.text(hotelPlace, 10, y);
    y += 18;
    doc.text(`Bill No: ${billNumber}`, 10, y);
    y += 20;

    const items = Array.from(document.querySelectorAll('.item-row')).map(row => ({
      name: row.querySelector('.item-name').value.trim(),
      rate: parseFloat(row.querySelector('.item-rate').value)
    })).filter(item => item.name && !isNaN(item.rate));

    doc.setFontSize(12);
    for (const item of items) {
      doc.text(item.name, 10, y);
      doc.text(item.rate.toFixed(2), 230, y, { align: 'right' });
      y += 16;
    }

    const total = items.reduce((sum, item) => sum + item.rate, 0).toFixed(2);
    y += 8;
    doc.setDrawColor(0, 0, 0);
    doc.line(10, y, 270, y);
    y += 12;
    doc.setFontSize(13);
    doc.text('Total', 10, y);
    doc.text(total, 230, y, { align: 'right' });

    y += 30;
    doc.setFontSize(10);
    doc.text('Thank you for your visit!', 10, y);

    doc.save(`bill_${billNumber}.pdf`);
  };
</script>

</body>
</html>